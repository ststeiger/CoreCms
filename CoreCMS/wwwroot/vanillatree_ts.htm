<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta charset="utf-8" />

    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />

    <title>Leaflet test</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.00, minimum-scale=1.00, maximum-scale=1.00" />

    <style type="text/css">
        html, body
        {
            margin: 0px;
            padding: 0px;
            width: 100%;
            height: 100%;
        }
    </style>
    <link rel="stylesheet" href="GeneratedScripts/vanillatree.css?v=1">
    
    <!--
    <script src="GeneratedScripts/balalaika.js?v=1"></script>
    -->
    <script src="GeneratedScripts/AsyncAjax.js?v=1"></script>
    <script src="GeneratedScripts/vanilla_tree.js?v=1"></script>
    
</head>
<body>
    <main></main>
    <footer></footer>
    <script>
        
        async function main() 
        {
            const main = document.querySelector('main');
            const info = document.querySelector('footer');
            const tree = new VT.VanillaTree({
                id: main,
                url: "jsonp",
                contextmenu: [{
                    label: 'Hey',
                    action: function (id)
                    {
                        alert('Hey ' + id);
                    }
                }, {
                    label: 'Blah',
                    action: function (id)
                    {
                        alert('Blah ' + id);
                    }
                }]
            });
            
            
            tree.addBranch(null);
            /*
            let childNodes = await new Http.PostJSON("treedata", { "id": null }).sendAsync();
            for (var i = 0; i < childNodes.Rows.length; ++i)
            {
                tree.add({
                    id: childNodes.Rows[i].uid, // this.newId(),
                    label: childNodes.Rows[i].text, // 'Node ' + (i+1).toString(),
                    parent: null,
                    opened: false,
                    hasChildren: childNodes.Rows[i].hasChildren
                });
            } // Next i 
            */



            /*
            tree.add({
                label: 'Label A',
                id: 'a',
                opened: true
            });
    
    
            tree.add({
                label: 'DB',
                id: 'BEB6CD1D-5ACB-4FB1-93F4-A3F07A053DB7',
                opened: true
            });
    
    
            tree.add({
                label: 'DB.1',
                parent: 'BEB6CD1D-5ACB-4FB1-93F4-A3F07A053DB7',
                id: null,
                opened: true,
                selected: true
            });
    
    
    
            tree.add({
                label: 'DB.2',
                parent: null,
                id: "omg",
                opened: true,
                selected: true
            });
    
    
    
    
            tree.add({
                label: 'Label B',
                id: 'b'
            });
    
            tree.add({
                label: 'Label A.A',
                parent: 'a',
                id: 'a.a',
                opened: true,
                selected: true
            });
    
            tree.add({
                label: 'Label A.A.A',
                parent: 'a.a'
            });
    
            tree.add({
                label: 'Label A.A.B',
                parent: 'a.a'
            });
    
            tree.add({
                label: 'Label B.A',
                parent: 'b'
            });
            */


            main.addEventListener('vtree-open', function (evt)
            {
                info.innerHTML = evt.detail.id + ' is opened';
            });

            main.addEventListener('vtree-close', function (evt)
            {
                info.innerHTML = evt.detail.id + ' is closed';
            });

            main.addEventListener('vtree-select', function (evt)
            {
                info.innerHTML = evt.detail.id + ' is selected';
            });
            
        }
        
        main();
        
    </script>

</body>
</html>
