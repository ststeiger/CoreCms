"use strict";var VT;!function(e){var t=function(){function e(e,t){this.autoBind(this),this.container="string"==typeof e||e instanceof String?document.querySelector(e):e,this.tree=this.container.appendChild(this.create("ul",{className:"vtree"})),this.placeholder=t&&t.placeholder,this._placeholder(),this.leafs={},this.tree.addEventListener("click",function(e){e.target.classList.contains("vtree-leaf-label")?this.select(e.target.parentNode.getAttribute("data-vtree-id")):e.target.classList.contains("vtree-toggle")&&this.toggle(e.target.parentNode.getAttribute("data-vtree-id"))}.bind(this)),t&&t.contextmenu&&(this.tree.addEventListener("contextmenu",function(e){var r,i=this.tree.querySelectorAll(".vtree-contextmenu");if([].forEach.call(i,function(e){e.parentElement.removeChild(e)}),e.target.classList.contains("vtree-leaf-label")){e.preventDefault(),e.stopPropagation(),r=this.create("menu",{className:"vtree-contextmenu"});var n=e.target.getBoundingClientRect();this.setProperties(r.style,{top:(e.target.offsetTop+n.height).toString()+"px",left:e.target.offsetLeft.toString()+"px",display:"block"}),t.contextmenu.forEach(function(t){r.appendChild(this.create("li",{className:"vtree-contextmenu-item",innerHTML:t.label})).addEventListener("click",t.action.bind(t,e.target.parentElement.getAttribute("data-vtree-id")))}.bind(this)),e.target.parentElement.appendChild(r)}}.bind(this)),document.addEventListener("click",function(e){var t=this.tree.querySelectorAll(".vtree-contextmenu");[].forEach.call(t,function(e){e.parentElement.removeChild(e)})}.bind(this)))}return e.prototype.autoBind=function(e){for(var t=0,r=Object.getOwnPropertyNames(e.constructor.prototype);t<r.length;t++){var i=r[t],n=e[i];"constructor"!==i&&"function"==typeof n&&(e[i]=n.bind(e))}return e},e.prototype.setProperties=function(e,t){if(t)for(var r=0,i=Object.keys(t);r<i.length;r++)e[i[r]]=t[i[r]];return e},e.prototype.create=function(e,t){return this.setProperties(document.createElement(e),t)},e.prototype._dispatch=function(e,t){var r;try{r=new CustomEvent("vtree-"+e,{bubbles:!0,cancelable:!0,detail:{id:t}})}catch(i){(r=document.createEvent("CustomEvent")).initCustomEvent("vtree-"+e,!0,!0,{id:t})}return(this.getLeaf(t,!0)||this.tree).dispatchEvent(r),this},e.prototype._placeholder=function(){var e;return!this.tree.children.length&&this.placeholder?this.tree.innerHTML='<li class="vtree-placeholder">'+this.placeholder+"</li>":(e=this.tree.querySelector(".vtree-placeholder"))&&this.tree.removeChild(e),this},e.prototype.getLeaf=function(e,t){var r=this.tree.querySelector('[data-vtree-id="'+e+'"]');if(!t&&!r)throw Error('No VanillaTreeWithoutAjax leaf with id "'+e+'"');return r},e.prototype.getChildList=function(e){var t,r;return e?(t=(r=this.getLeaf(e)).querySelector("ul"))||(t=r.appendChild(this.create("ul",{className:"vtree-subtree"}))):t=this.tree,t},e.prototype.add=function(e){var t,r=this.create("li",{className:"vtree-leaf"}),i=this.getChildList(e.parent);return r.setAttribute("data-vtree-id",t=e.id||Math.random().toString()),r.appendChild(this.create("span",{className:"vtree-toggle"})),r.appendChild(this.create("a",{className:"vtree-leaf-label",innerHTML:e.label})),i.appendChild(r),i!==this.tree&&i.parentElement.classList.add("vtree-has-children"),this.leafs[t]=e,e.opened||this.close(t),e.selected&&this.select(t),this._placeholder()._dispatch("add",t)},e.prototype.move=function(e,t){var r=this.getLeaf(e),i=r.parentElement,n=this.getLeaf(t,!0);return n&&n.classList.add("vtree-has-children"),this.getChildList(t).appendChild(r),i.parentElement.classList.toggle("vtree-has-children",!!i.children.length),this._dispatch("move",e)},e.prototype.remove=function(e){var t=this.getLeaf(e),r=t.parentElement;return r.removeChild(t),r.parentElement.classList.toggle("vtree-has-children",!!r.children.length),this._placeholder()._dispatch("remove",e)},e.prototype.open=function(e){return this.getLeaf(e).classList.remove("closed"),this.add({id:"123",label:"ABC",parent:null}),this._dispatch("open",e)},e.prototype.close=function(e){return this.getLeaf(e).classList.add("closed"),this._dispatch("close",e)},e.prototype.toggle=function(e){return this[this.getLeaf(e).classList.contains("closed")?"open":"close"](e)},e.prototype.select=function(e){var t,r=this.getLeaf(e);return r.classList.contains("vtree-selected")||(t=this.tree.querySelectorAll("li.vtree-leaf"),[].forEach.call(t,function(e){e.classList.remove("vtree-selected")}),r.classList.add("vtree-selected"),this._dispatch("select",e)),this},e}();e.VanillaTreeWithoutAjax=t}(VT||(VT={}));